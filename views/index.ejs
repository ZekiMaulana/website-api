<%- include("partials/headers.ejs") %>

<section class="main-content">
  <% const ranNum = Math.floor(Math.random() * content.data.length) %>
  <% const topAired = content.data %>

  <div class="content-title">
    <h1><%= topAired[ranNum].title %></h1>
    <span><%= topAired[ranNum].aired.prop.from.day %>. 
      <% var month = topAired[ranNum].aired.string.split(" ")[0] %>
      <%= month %>, 
      <%= topAired[ranNum].aired.prop.from.year %></span>
    <div class="score">
      <button class="score-button"><%= topAired[ranNum].score %></button>
      <% const score = Math.floor(topAired[ranNum].score) %>
      <p><% for(var i= 1; i<= 10; i++) { if(i <= score) { %><img src="/images/star.svg" height="30px"><% } else { %><img src="/images/star-blank.svg" height="30px"><% }} %><br>
        <img src="/images/profile.svg" height="20px"> <%= topAired[ranNum].scored_by %> Votes</p>
    </div>
    <b>| <% topAired[ranNum].genres.forEach(genre => { %><%= genre.name %> | <% }) %>
      <% topAired[ranNum].explicit_genres.forEach(genre => { %><%= genre.name %> | <% }) %>
      <% topAired[ranNum].themes.forEach(genre => { %><%= genre.name %> | <% }) %>
      <% topAired[ranNum].demographics.forEach(genre => { %><%= genre.name %> | <% }) %></b>
    <p><%= topAired[ranNum].synopsis.slice(0, 240) %>...<br><a href="">Continue reading</a></p>
  </div>

  <div class="content-video">
      <% if(topAired[ranNum].trailer.embed_url === null){ %>
        <div style="text-align: center;">
          <img class="card" src=<%= topAired[ranNum].images.jpg.large_image_url %>>
          <h1>Video Content not Found</h1>
        </div>
          
        <% } else { %>
        <iframe class="card video-box" src=<%= topAired[ranNum].trailer.embed_url %>></iframe>
      <% } %>
  </div>
  
  <div class="text-title title-featured"><h2>Featured</h2></div>
  
  <% topAired.forEach(anime => { %>

    <div class="card-film">
      <a href="" style="color: black;">
      <div class="card-img">
      <img class="card" src=<%= anime.images.jpg.large_image_url %> width="98%" height="325px">
      <div class="text1">Featured</div>
      <div class="centered"><%= anime.synopsis.slice(0,300) %>....</div>
      <div class="text2">âœ© <%= anime.score %></div>
      </div>
      <% var title_name = anime.title + " (" + anime.year + ")" %>
      <h4><%= title_name.slice(0, 26) %></h4>
      </a>
      <p><%= anime.aired.prop.from.day %> <% var month = anime.aired.string.split(" ")[0] %><%= month %> <%= anime.aired.prop.from.year %></p>
    </div>
   <% }); %>
   <div class="line"><hr /></div>
  
</section>
<%# topAired.forEach(anime => { %>

    <%# anime.mal_id %>
    <%# anime.score %>
    <%# anime.synopsis %>
    <%# anime.aired.string %>
    <%# anime.images.jpg.large_image_url %>
    <%# anime.title_english %>

  <%# }); %>
<%- include("partials/footers.ejs") %>